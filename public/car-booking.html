<!-- Tabella per visualizzare l'elenco delle auto -->
<table id="carsBookingTable">
    <thead>
        <tr>
            <th>ID Prenotazione</th>
            <th>Modello</th>
            <th>Nome Cliente</th>
            <th>Data Prenotazione</th>
            <th>Stato</th>
            <th>Azioni</th>
        </tr>
    </thead>
    <tbody>
      <!-- Le righe verranno inserite dinamicamente tramite JavaScript -->
    </tbody>
  </table>


  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
    }
    .booked {
      background-color: #4CAF50;
      color: white;
    }
    .status-active {
      background-color: #4CAF50;
      color: white;
    }
    .status-completed {
      background-color: #2196F3;
      color: white;
    }
    .status-cancelled {
      background-color: #f44336;
      color: white;
    }
    .actions button {
      width: 100%;
      padding: 8px 10px;
      margin: 5px;
      cursor: pointer;
    }

  
/* CSS */
.button-7 {
  background-color: #0095ff;
  border: 1px solid transparent;
  border-radius: 3px;
  box-shadow: rgba(255, 255, 255, .4) 0 1px 0 0 inset;
  box-sizing: border-box;
  color: #fff;
  cursor: pointer;
  display: inline-block;
  font-family: -apple-system,system-ui,"Segoe UI","Liberation Sans",sans-serif;
  font-size: 13px;
  font-weight: 400;
  line-height: 1.15385;
  outline: none;
  padding: 8px .8em;
  position: relative;
  text-align: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  vertical-align: baseline;
  white-space: nowrap;
}

.button-7:hover,
.button-7:focus {
  background-color: #07c;
}

.button-7:focus {
  box-shadow: 0 0 0 4px rgba(0, 149, 255, .15);
}

.button-7:active {
  background-color: #0064bd;
  box-shadow: none;
}

/* CSS */
.button-8 {
  background-color: #e1ecf4;
  border-radius: 3px;
  border: 1px solid #7aa7c7;
  box-shadow: rgba(255, 255, 255, .7) 0 1px 0 0 inset;
  box-sizing: border-box;
  color: #39739d;
  cursor: pointer;
  display: inline-block;
  font-family: -apple-system,system-ui,"Segoe UI","Liberation Sans",sans-serif;
  font-size: 13px;
  font-weight: 400;
  line-height: 1.15385;
  outline: none;
  padding: 8px .8em;
  position: relative;
  text-align: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  vertical-align: baseline;
  white-space: nowrap;
}

.button-8:hover,
.button-8:focus {
  background-color: #b3d3ea;
  color: #2c5777;
}

.button-8:focus {
  box-shadow: 0 0 0 4px rgba(0, 149, 255, .15);
}

.button-8:active {
  background-color: #a0c7e4;
  box-shadow: none;
  color: #2c5777;
}
</style>


<script>
    const API_URL = 'https://server-node-igna.vercel.app/carsRental';

    // Funzione per ottenere e visualizzare le prenotazioni
    async function getBookings() {
      try {
        const response = await fetch(API_URL);
        const bookings = await response.json();

        const tbody = document.querySelector('#carsBookingTable tbody');
        tbody.innerHTML = ''; // Svuota la tabella

        bookings.forEach(booking => {
          const row = document.createElement('tr');

          // Imposta la classe di stato per colorare la cella in base allo stato
          let statusClass = '';
          switch (booking.status) {
            case 'booked':
              statusClass = 'status-booked'; 
              break;
            case 'active':
              statusClass = 'status-active'; 
              break;
            case 'completed':
              statusClass = 'status-completed';
              break;
            case 'cancelled':
              statusClass = 'status-cancelled';
              break;
            default:
              statusClass = '';
          }

          row.innerHTML = `
            <td>${booking._id}</td>
            <td>${booking.carId.model}</td>
            <td>${booking.user}</td>
            <td>${new Date(booking.startTime).toLocaleDateString()}</td>
            <td class="${statusClass}">${booking.status}</td>
            <td class="actions">
              <button class="button-7" onclick="viewBooking('${booking._id}')">Visualizza</button>
              <button class="button-8" onclick="cancelBooking('${booking._id}')">Annulla</button>
            </td>
          `;

          tbody.appendChild(row);
        });
      } catch (error) {
        console.error("Errore nel recupero delle prenotazioni:", error);
      }
    }

    // Richiama la funzione per caricare le prenotazioni quando la pagina viene caricata
    window.onload = getBookings;
</script>
